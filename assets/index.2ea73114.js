import{r as e,o as t,c as a,a as s,w as i,b as o,d as l,e as r,f as n,g as d,p as c,h as m,i as p,j as u,k as h,t as y,F as g,l as b,m as v,n as f,q as k,V as S,s as T}from"./vendor.db1e1251.js";const D={id:"App"},_={id:"Nav"},w=o("Home"),C=o("Edit"),P=o("Play");const E={};let B;E.render=function(o,l){const r=e("el-menu-item"),n=e("el-menu"),d=e("router-view");return t(),a("div",D,[s("div",_,[s(n,{class:"el-menu-demo",mode:"horizontal",router:!0},{default:i((()=>[s(r,{index:"/"},{default:i((()=>[w])),_:1}),s(r,{index:"edit"},{default:i((()=>[C])),_:1}),s(r,{index:"play"},{default:i((()=>[P])),_:1})])),_:1})]),s(d)])};const M={},V=function(e,t){if(!t||0===t.length)return e();if(void 0===B){const e=document.createElement("link").relList;B=e&&e.supports&&e.supports("modulepreload")?"modulepreload":"preload"}return Promise.all(t.map((e=>{if((e=`./${e}`)in M)return;M[e]=!0;const t=e.endsWith(".css"),a=t?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${e}"]${a}`))return;const s=document.createElement("link");return s.rel=t?"stylesheet":B,t||(s.as="script",s.crossOrigin=""),s.href=e,document.head.appendChild(s),t?new Promise(((e,t)=>{s.addEventListener("load",e),s.addEventListener("error",t)})):void 0}))).then((()=>e()))},I=[{path:"/",name:"Home",component:()=>V((()=>import("./Home.69627425.js")),["assets/Home.69627425.js","assets/vendor.db1e1251.js"])},{path:"/edit",name:"Edit",component:()=>V((()=>import("./Edit.a391a92e.js")),["assets/Edit.a391a92e.js","assets/Edit.80fc92f8.css","assets/vendor.db1e1251.js"])},{path:"/play",name:"Play",component:()=>V((()=>import("./Play.a132ba0a.js")),["assets/Play.a132ba0a.js","assets/Play.8e9c9694.css","assets/vendor.db1e1251.js"])}],x=l({history:r("#"),routes:I});var $=n({state:{setting:{bpm:1,viewDegree:15,mapSetting:[{key:"a",color:"red",timeStamp:[]},{key:"s",color:"orange",timeStamp:[]},{key:"d",color:"yellow",timeStamp:[]},{key:"f",color:"green",timeStamp:[]},{key:"4",color:"blue",timeStamp:[]},{key:"5",color:"purple",timeStamp:[]},{key:"6",color:"black",timeStamp:[]}]},mapData:[{key:"a",color:"red",timeStamp:[]},{key:"s",color:"orange",timeStamp:[]},{key:"d",color:"yellow",timeStamp:[]},{key:"f",color:"green",timeStamp:[]},{key:"4",timeStamp:[],color:"blue"},{key:"5",color:"purple",timeStamp:[]},{key:"6",color:"black",timeStamp:[]}]},getters:{getMapData:e=>e.mapData,getBpm:e=>e.setting.bpm,getViewDegree:e=>e.setting.viewDegree},mutations:{saveMapData(e,t){e.mapData=t},setBpm(e,t){e.setting.bpm=t}},actions:{},modules:{},plugins:[d()]});const L=p("data-v-db0cbfe0");c("data-v-db0cbfe0");const j=s("div",{class:"image"},[s("img",{src:"https://shadow.elemecdn.com/app/element/hamburger.9cf7b091-55e9-11e9-a976-7f4d0b07eef6.png"})],-1),R=s("h1",null,"S",-1),A=o("sdasdads"),N=o("ASD"),O=o("ASD"),z=o("SS"),H=o("7"),U=o("4:33"),q=o("60%"),Q=o("1560");m();const X=L(((i,o,l,r,n,d)=>{const c=e("el-descriptions-item"),m=e("el-descriptions"),p=e("el-card");return t(),a(p,{class:"music_card",shadow:"hover","body-style":{padding:"0px"}},{default:L((()=>[j,s(m,{class:"info",title:"歌曲名稱",column:1},{extra:L((()=>[R])),default:L((()=>[s(c,{label:"作者"},{default:L((()=>[A])),_:1}),s(c,{label:"原曲"},{default:L((()=>[N])),_:1}),s(c,{label:"原曲頻道"},{default:L((()=>[O])),_:1}),s(c,{label:"難度"},{default:L((()=>[z])),_:1}),s(c,{label:"鍵位"},{default:L((()=>[H])),_:1}),s(c,{label:"長度"},{default:L((()=>[U])),_:1}),s(c,{label:"滿意度"},{default:L((()=>[q])),_:1}),s(c,{label:"遊玩數"},{default:L((()=>[Q])),_:1})])),_:1})])),_:1})}));const Y={data:()=>({aa:"asd"})};Y.render=X,Y.__scopeId="data-v-db0cbfe0";const F=p("data-v-d6704fb0");c("data-v-d6704fb0");const W={id:"playboard"},G={class:"toolBar"},J=o("Play"),K=o("Pause"),Z={class:"player"},ee=s("div",{id:"player"},null,-1),te={class:"full-screen"};m();const ae=F(((i,l,r,n,d,c)=>{const m=e("el-slider"),p=e("el-button"),v=e("game_slider"),f=u("loading");return t(),a("div",W,[h(s("div",G,[s(m,{class:"slider",modelValue:d.viewDegree,"onUpdate:modelValue":l[1]||(l[1]=e=>d.viewDegree=e),vertical:"",height:"10vh",max:80},null,8,["modelValue"]),s(p,{onClick:l[2]||(l[2]=e=>c.gameStart()),icon:"el-icon-video-play",round:"",type:"primary",disabled:1==d.playerState},{default:F((()=>[J])),_:1},8,["disabled"]),s(p,{onClick:l[3]||(l[3]=e=>c.gamePause()),icon:"el-icon-video-pause",round:"",type:"success",disabled:1!=d.playerState},{default:F((()=>[K])),_:1},8,["disabled"]),s("p",null,y(d.score),1)],512),[[f,d.loading]]),s("div",{class:"row",style:c.playBoardStyle()},[h(s("div",Z,[ee],512),[[f,d.loading]]),(t(!0),a(g,null,b(c.getMapData,((e,i)=>(t(),a("div",te,[s("div",{class:"screen",id:"S"+e.key},[(t(!0),a(g,null,b(e.timeStamp,((s,i)=>(t(),a(v,{onClick:l[4]||(l[4]=e=>c.destroy()),class:e.key,color:e.color,bornTime:s,currentTime:d.currentTime,bpm:c.getBpm},null,8,["class","color","bornTime","currentTime","bpm"])))),256))],8,["id"]),s(p,{class:"button shadow",style:c.getButtonStyle(e.color),size:"medium",onClick:t=>c.hit(e.key,e.color),id:"B"+e.key},{default:F((()=>[o(y(e.key),1)])),_:2},1032,["style","onClick","id"])])))),256))],4)])}));const se={props:{musicData:Object},data:()=>({loading:!0,viewDegree:0,currentTime:null,choiceTime:null,player:null,score:0,combo:0,maxCombo:0,lifeTimer:null,playerState:0}),computed:{getMapData(){return this.$store.getters.getMapData},getBpm(){return this.$store.getters.getBpm},getviewDegree(){return this.$store.getters.getviewDegree}},methods:{gameStart(){this.player.playVideo(),this.currentTime=this.player.getCurrentTime(),this.lifeTimer=setInterval((()=>{1===this.playerState&&(this.currentTime+=.015)}),15)},gamePause(){2!==this.playerState&&(this.player.pauseVideo(),this.currentTime=this.player.getCurrentTime(),console.log("pase"+this.currentTime),clearInterval(this.lifeTimer))},playBoardStyle(){return{transform:`\n        rotateX(${this.viewDegree}deg)\n        scale(${1-this.viewDegree/170})`}},getButtonStyle:e=>({background:e}),hit(e,t){const a=document.getElementsByClassName(e);a.length>0&&(this.appendEffect(e,a[0].style.top,t),a[0].click())},judge(e){var t=parseInt(e),a="";return 80>=t&&t>=79?(this.score+=100,this.combo++,a="perfect"):82>=t&&t>=80||79>=t&&t>=75?(this.score+=30,this.combo++,a="excellent"):85>=t&&t>=82||75>=t&&t>=70?(this.score+=10,this.combo++,a="good"):(this.combo=0,a="miss"),this.combo>10&&this.combo<=30?this.score+=5:this.combo>30&&this.combo<=50?this.score+=10:this.combo>50&&this.combo<=100?this.score+=25:this.combo>100&&this.combo<=200?this.score+=35:this.combo>200&&(this.score+=50),this.combo>this.maxCombo&&(this.maxCombo=this.combo),a},appendEffect(e,t,a){const s=document.getElementById("S"+e),i=document.createElement("div");i.appendChild(document.createTextNode(`${this.judge(t)}`)),i.classList.add("effect"),i.style.top=t,i.style.background=a,s.appendChild(i),setTimeout((()=>{i.remove()}),300)},destroy(){this.$emit("destroy")},onPlayerReady(e){this.loading=!1,this.player.setPlaybackQuality("medium")},onPlayerStateChange(e){this.playerState=e.data,console.log(this.playerState)}},mounted(){this.viewDegree=this.getViewDegree,this.player=new YT.Player("player",{videoId:this.musicData.id,width:"100%",height:"100%",playerVars:{loop:1,rel:0},events:{onReady:this.onPlayerReady,onStateChange:this.onPlayerStateChange}})},created(){const e=this;document.onkeydown=function(t){e.musicData.mapData.map((e=>{if(e.key===t.key){const t=document.getElementById("B"+e.key);t.click(),t.classList.add("show"),setTimeout((()=>{t.classList.remove("show")}),300)}}))}}};se.render=ae,se.__scopeId="data-v-d6704fb0";const ie=p("data-v-57c906b2");c("data-v-57c906b2");const oe={id:"editboard"},le={class:"toolBar"},re=o("Play"),ne=o("Pause"),de=o("Save"),ce={class:"player"},me={id:"player"},pe={class:"full-screen"};m();const ue=ie(((i,l,r,n,d,c)=>{const m=e("el-slider"),p=e("el-button"),v=u("loading");return t(),a("div",oe,[h(s("div",le,[s(m,{class:"slider",modelValue:d.viewDegree,"onUpdate:modelValue":l[1]||(l[1]=e=>d.viewDegree=e),vertical:"",height:"10vh",max:80},null,8,["modelValue"]),s(p,{onClick:l[2]||(l[2]=e=>c.gameStart()),icon:"el-icon-video-play",round:"",type:"primary",disabled:1==d.playerState},{default:ie((()=>[re])),_:1},8,["disabled"]),s(p,{onClick:l[3]||(l[3]=e=>c.gamePause()),icon:"el-icon-video-pause",round:"",type:"success",disabled:1!=d.playerState},{default:ie((()=>[ne])),_:1},8,["disabled"]),s(p,{onClick:l[4]||(l[4]=e=>c.saveMapData()),plain:"",icon:"el-icon-finished",round:"",type:"warning"},{default:ie((()=>[de])),_:1})],512),[[v,d.loading]]),s(m,{modelValue:d.currentTime,"onUpdate:modelValue":l[5]||(l[5]=e=>d.currentTime=e),height:"300",max:r.musicData.duration,"show-input":"",onInput:l[6]||(l[6]=e=>c.seekTo()),onChange:l[7]||(l[7]=e=>c.seekToConfirm())},null,8,["modelValue","max"]),s("div",{class:"row",style:c.playBoardStyle()},[s("div",ce,[h(s("div",me,null,512),[[v,d.loading]])]),(t(!0),a(g,null,b(c.getMapData,((e,i)=>(t(),a("div",pe,[s("div",{class:"screen",id:"S"+e.key},null,8,["id"]),s(p,{class:"button shadow",style:c.getButtonStyle(e.color),size:"medium",onClick:t=>c.hit(e.key,e.color),id:"B"+e.key},{default:ie((()=>[o(y(e.key),1)])),_:2},1032,["style","onClick","id"])])))),256))],4)])}));const he={props:{musicData:Object},data:()=>({loading:!0,viewDegree:0,currentTime:null,choiceTime:null,player:null,score:0,combo:0,lifeTimer:null,playerState:0,newMap:[]}),computed:{getMapData(){return this.$store.getters.getMapData},getviewDegree(){return this.$store.getters.getviewDegree}},methods:{gameStart(){console.log(this.player),this.player.playVideo(),this.lifeTimer=setInterval((()=>{1===this.playerState&&(this.currentTime+=.05)}),50)},gamePause(){this.player.pauseVideo(),clearInterval(this.lifeTimer)},playBoardStyle(){return{transform:`\n        rotateX(${this.viewDegree}deg)\n        scale(${1-this.viewDegree/170})`}},getButtonStyle:e=>({background:e}),hit(e,t){1===this.playerState&&(this.appendEffect(e,t),this.judge(),this.editMap(e,this.player.getCurrentTime()))},editMap(e,t){this.getAMapData(e).timeStamp.push(t)},getAMapData(e){return this.newMap.find((t=>t.key===e))},initMap(){this.getMapData.map((e=>{var t={key:e.key,color:e.color,timeStamp:[]};this.newMap.push(t)}))},saveMapData(){this.newMap.forEach((e=>{e.timeStamp.sort()})),this.$store.commit("saveMapData",this.newMap),this.$notify({title:"Map Data",message:v("i",{style:"color: teal"},"已儲存資料")})},judge(){this.score+=100,this.combo++,this.combo>10&&this.combo<=30?this.score+=5:this.combo>30&&this.combo<=50?this.score+=10:this.combo>50&&this.combo<=100?this.score+=25:this.combo>100&&this.combo<=200?this.score+=35:this.combo>200&&(this.score+=50)},appendEffect(e,t){const a=document.getElementById("S"+e),s=document.createElement("div");s.appendChild(document.createTextNode("perfect")),s.classList.add("effect"),s.style.top="80%",s.style.background=t,a.appendChild(s),setTimeout((()=>{s.remove()}),300)},seekTo(){1!==this.playerState&&this.player.seekTo(this.currentTime)},seekToConfirm(){this.player.seekTo(this.currentTime)},onPlayerReady(e){this.loading=!1,this.player.setPlaybackQuality("medium")},onPlayerStateChange(e){this.playerState=e.data}},mounted(){this.player=new YT.Player("player",{videoId:this.musicData.id,width:"100%",height:"100%",playerVars:{loop:1,rel:0},events:{onReady:this.onPlayerReady,onStateChange:this.onPlayerStateChange}}),this.initMap()},created(){const e=this;document.onkeydown=function(t){e.musicData.mapData.map((e=>{if(e.key===t.key){const t=document.getElementById("B"+e.key);t.click(),t.classList.add("show"),setTimeout((()=>{t.classList.remove("show")}),300)}}))}}};he.render=ue,he.__scopeId="data-v-57c906b2";const ye=p("data-v-19c2fdd9")(((e,s,i,o,l,r)=>r.exist?(t(),a("div",{key:0,class:"game_slider",style:r.gameSliderStyle,onClick:s[1]||(s[1]=e=>r.destroy())},null,4)):f("",!0)));const ge={data:()=>({break:!1}),props:{bpm:Number,color:String,bornTime:Number,currentTime:Number},computed:{gameSliderStyle(){return{top:this.top+"%",background:this.color}},top(){return this.sneak-this.bornTime>0?75*(this.sneak-this.bornTime)*this.bpm:0},sneak(){return 1===this.bpm?this.currentTime+1.15:1.5===this.bpm?this.currentTime+.83:2===this.bpm?this.currentTime+.56:.5===this.bpm?this.currentTime+2.1:.25===this.bpm?this.currentTime+4.35:void 0},exist(){return this.top>0&&this.top<100&&!1===this.break}},methods:{destroy(){this.break=!0}}};ge.render=ye,ge.__scopeId="data-v-19c2fdd9";const be=k(E);be.use(x),be.use($),be.use(S),be.use(T),be.component("music_card",Y),be.component("playboard",se),be.component("editboard",he),be.component("game_slider",ge),be.mount("#app");
